"use strict";(self.webpackChunkquestionnaire=self.webpackChunkquestionnaire||[]).push([[448],{81317:(e,n,s)=>{s.r(n),s.d(n,{default:()=>Oe});var i=s(72791);const t="Edit_container__6sY1S",c="Edit_content-wrapper__dAInz",d="Edit_content__qIqOv",l="Edit_left__8pEFV",r="Edit_main__yaZjf",a="Edit_canvas-wrapper__T6wyU",o="Edit_right__iSU2t";var x=s(14692),j=s(59434),u=s(81694),p=s.n(u);const h="EditCanvas_canvas__t323a",m="EditCanvas_component-wrapper__3Tni6",Z="EditCanvas_locked__4m764",_="EditCanvas_selected__DiSVG",f="EditCanvas_component__UOp7q";var v=s(42573),C=s(61554),E=s(21465),k=s(15297),y=s(15119);const I=()=>{const e=document.activeElement;return e===document.body||!(null===e||void 0===e||!e.matches('div[role="button"]'))},P=()=>{const e=(0,j.I0)();(0,E.Z)(["backspace","delete"],(()=>{I()&&e((0,y.c)())})),(0,E.Z)(["ctrl.c","meta.c"],(()=>{I()&&e((0,y.pG)())})),(0,E.Z)(["ctrl.v","meta.v"],(()=>{I()&&e((0,y.lb)())})),(0,E.Z)("uparrow",(()=>{e((0,y.im)())})),(0,E.Z)("downarrow",(()=>{e((0,y.cA)())})),(0,E.Z)(["ctrl.z","meta.z"],(()=>{e(k.zF.undo())}),{exactMatch:!0}),(0,E.Z)(["ctrl.shift.z","meta.shift.z"],(()=>{e(k.zF.redo())}),{exactMatch:!0})};var b=s(25216),N=s(43893),g=s(80184);const w=e=>{const{children:n,items:s,onDragEnd:i}=e,t=(0,b.Dy)((0,b.VT)(b.MA,{activationConstraint:{distance:8}}));return(0,g.jsx)(b.LB,{sensors:t,collisionDetection:b.pE,onDragEnd:function(e){const{active:n,over:t}=e;if(null!==t&&n.id!==t.id){const e=s.findIndex((e=>e.id===n.id)),c=s.findIndex((e=>e.id===t.id));i(e,c)}},children:(0,g.jsx)(N.Fo,{items:s,strategy:N.qw,children:n})})};var L=s(68218);const T=e=>{let{id:n,children:s}=e;const{attributes:i,listeners:t,setNodeRef:c,transform:d,transition:l}=(0,N.nB)({id:n}),r={transform:L.ux.Transform.toString(d),transition:l};return(0,g.jsx)("div",{ref:c,style:r,...i,...t,children:s})};function K(e){const{type:n,props:s}=e,i=(0,C.d)(n);if(!i)return null;const{Component:t}=i;return(0,g.jsx)(t,{...s})}const S=e=>{const{loading:n}=e,{componentList:s,selectedId:i}=(0,v.Z)(),t=(0,j.I0)();if(P(),n)return(0,g.jsx)("div",{style:{textAlign:"center",marginTop:"24px"},children:(0,g.jsx)(x.Z,{})});const c=s.map((e=>({...e,id:e.id})));return(0,g.jsx)(w,{items:c,onDragEnd:function(e,n){t((0,y.U)({oldIndex:e,newIndex:n}))},children:(0,g.jsx)("div",{className:h,children:s.filter((e=>!e.isHidden)).map((e=>{const{id:n,isLocked:s}=e,c=m,d=_,l=Z,r=p()({[c]:!0,[d]:n===i,[l]:s});return(0,g.jsx)(T,{id:n,children:(0,g.jsx)("div",{className:r,onClick:e=>function(e,n){e.stopPropagation(),t((0,y.$i)(n))}(e,n),children:(0,g.jsx)("div",{className:f,children:K(e)})},n)},n)}))})})};var z=s(91669),F=s(96230),H=s(68961),U=s(91806),q=s(53696),D=s(25984);const O="ComponentLib_container__KS4F0",Y="ComponentLib_wrapper__wi1jU",G="ComponentLib_component__Nys+s",{Title:V}=q.default;const A=()=>(0,g.jsx)("div",{className:O,children:C.E.map(((e,n)=>(0,g.jsxs)("div",{children:[(0,g.jsx)(V,{level:3,style:{fontSize:"16px",marginTop:n>0?"20px":"0px"},children:e.groupName}),(0,g.jsx)("div",{children:e.components.map((e=>function(e){const{Component:n,title:s,type:t,defaultProps:c}=e,d=(0,j.I0)(),l=(0,i.useCallback)((()=>{d((0,y.Tk)({id:(0,D.x0)(5),title:s,type:t,props:c}))}),[]);return(0,g.jsx)("div",{className:Y,onClick:l,children:(0,g.jsx)("div",{className:G,children:(0,g.jsx)(n,{})})},t)}(e)))})]},e.groupId)))});var R=s(46988),M=s(86005),B=s(71046),$=s(2641),J=s(98272),W=s(38999);const X="Layers_wrapper__Pp+-M",Q="Layers_title__xkRcI",ee="Layers_selected__G08Pb",ne="Layers_handler__K72CK",se="Layers_btn__WWmi+",ie=()=>{const{componentList:e,selectedId:n}=(0,v.Z)(),[s,t]=(0,i.useState)(""),c=(0,j.I0)();function d(e){const s=e.target.value.trim();s&&n&&c((0,y.JE)({id:n,title:s}))}const l=e.map((e=>({...e,id:e.id})));return(0,g.jsx)(w,{items:l,onDragEnd:function(e,n){c((0,y.U)({oldIndex:e,newIndex:n}))},children:e.map((i=>{const{id:l,title:r,isHidden:a,isLocked:o}=i,x=Q,j=ee,u=p()({[x]:!0,[j]:l===n});return(0,g.jsx)(T,{id:l,children:(0,g.jsxs)("div",{className:X,children:[(0,g.jsx)("div",{className:u,onClick:()=>function(s){const i=e.find((e=>e.id===s));if(!i||!i.isHidden)return s!==n?(c((0,y.$i)(s)),void t("")):void t(s);R.ZP.info("\u8be5\u7ec4\u4ef6\u5df2\u9690\u85cf\uff0c\u65e0\u6cd5\u70b9\u51fb")}(l),children:l===s&&(0,g.jsx)(M.default,{value:r,onChange:d,onPressEnter:()=>t(""),onBlur:()=>t("")})||r}),(0,g.jsx)("div",{className:ne,children:(0,g.jsxs)(B.Z,{children:[(0,g.jsx)($.ZP,{size:"small",shape:"circle",className:a?"":se,icon:(0,g.jsx)(J.Z,{}),type:a?"primary":"default",onClick:()=>function(n){const s=e.find((e=>e.id===n));s&&c((0,y.uN)({id:n,isHidden:!s.isHidden}))}(l)}),(0,g.jsx)($.ZP,{size:"small",shape:"circle",className:o?"":se,icon:(0,g.jsx)(W.Z,{}),type:o?"primary":"default",onClick:()=>function(e){c((0,y.ij)({id:e}))}(l)})]})})]})},l)}))})},te=()=>{const e=[{key:"componentLib",label:(0,g.jsxs)("span",{children:[(0,g.jsx)(H.Z,{}),"\u7ec4\u4ef6\u5e93"]}),children:(0,g.jsx)(A,{})},{key:"layers",label:(0,g.jsxs)("span",{children:[(0,g.jsx)(U.Z,{}),"\u56fe\u5c42"]}),children:(0,g.jsx)(ie,{})}];return(0,g.jsx)(F.Z,{items:e,defaultActiveKey:"componentLib"})};var ce=s(13876),de=s(92414);const le=()=>{const{selectedComponent:e}=(0,v.Z)(),n=(0,j.I0)();const{type:s="",props:i,isLocked:t}=e||{},c=(0,C.d)(s),{PropComponent:d}=c||{};return d?(0,g.jsx)(d,{...i,onChange:function(s){if(!e)return;const{id:i}=e;n((0,y.gL)({id:i,newProps:s}))},disabled:t}):(0,g.jsx)(g.Fragment,{children:(0,g.jsx)("div",{children:"\u9519\u8bef"})})};var re=s(5353),ae=s(12044),oe=s(82463);const{TextArea:xe}=M.default,je=()=>{const{title:e,desc:n,js:s,css:t}=(0,ae.Z)(),[c]=re.Z.useForm(),d=(0,j.I0)();return(0,i.useEffect)((()=>{c.setFieldsValue({title:e,desc:n,js:s,css:t})}),[e,n,s,t]),(0,g.jsxs)(re.Z,{form:c,initialValues:{title:e,desc:n,js:s,css:t},onValuesChange:function(){d((0,oe.wO)(c.getFieldsValue()))},layout:"vertical",children:[(0,g.jsx)(re.Z.Item,{name:"title",label:"\u9875\u9762\u6807\u9898",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u9875\u9762\u6807\u9898"}],children:(0,g.jsx)(M.default,{})}),(0,g.jsx)(re.Z.Item,{name:"desc",label:"\u9875\u9762\u63cf\u8ff0",children:(0,g.jsx)(xe,{})}),(0,g.jsx)(re.Z.Item,{name:"js",label:"\u9875\u9762\u811a\u672c",children:(0,g.jsx)(xe,{})}),(0,g.jsx)(re.Z.Item,{name:"css",label:"\u9875\u9762\u6837\u5f0f",children:(0,g.jsx)(xe,{})})]})};var ue=function(e){return e.PROP_KEY="prop",e.SETTING_KEY="setting",e}(ue||{});const pe=()=>{const[e,n]=(0,i.useState)(ue.PROP_KEY),{selectedId:s}=(0,v.Z)(),t=(0,j.I0)();(0,i.useEffect)((()=>{n(s?ue.PROP_KEY:ue.SETTING_KEY)}),[s]);const c=[{key:ue.PROP_KEY,label:(0,g.jsxs)("span",{children:[(0,g.jsx)(ce.Z,{}),"\u5c5e\u6027"]}),children:(0,g.jsx)(le,{})},{key:ue.SETTING_KEY,label:(0,g.jsxs)("span",{onClick:function(){t((0,y.$i)("")),n(ue.SETTING_KEY)},children:[(0,g.jsx)(de.Z,{}),"\u9875\u9762\u8bbe\u7f6e"]}),children:(0,g.jsx)(je,{})}];return(0,g.jsx)(F.Z,{items:c,activeKey:e})};var he=s(57689),me=s(28641),Ze=s(18406),_e=s(31752),fe=s(77106),ve=s(76864),Ce=s(61431),Ee=s(82622),ke=s(23414),ye=s(32426),Ie=s(40447),Pe=s(10430),be=s(78030),Ne=s(50446);const ge=()=>{const e=(0,j.I0)(),{selectedId:n,selectedComponent:s,copiedComponents:i,componentList:t=[]}=(0,v.Z)(),{isLocked:c}=s||{},d=t.findIndex((e=>e.id===n)),l=d<=0,r=d>=t.length-1;return(0,g.jsx)("div",{children:(0,g.jsxs)(B.Z,{children:[(0,g.jsx)(Ce.Z,{title:"\u5220\u9664",children:(0,g.jsx)($.ZP,{shape:"circle",icon:(0,g.jsx)(Ee.Z,{}),onClick:function(){e((0,y.c)())}})}),(0,g.jsx)(Ce.Z,{title:"\u9690\u85cf",children:(0,g.jsx)($.ZP,{shape:"circle",icon:(0,g.jsx)(J.Z,{}),onClick:function(){e((0,y.uN)({id:n,isHidden:!0}))}})}),(0,g.jsx)(Ce.Z,{title:"\u9501\u5b9a",children:(0,g.jsx)($.ZP,{shape:"circle",icon:(0,g.jsx)(W.Z,{}),onClick:function(){e((0,y.ij)({id:n}))},type:c?"primary":"default"})}),(0,g.jsx)(Ce.Z,{title:"\u590d\u5236",children:(0,g.jsx)($.ZP,{shape:"circle",icon:(0,g.jsx)(ke.Z,{}),onClick:function(){e((0,y.pG)())}})}),(0,g.jsx)(Ce.Z,{title:"\u7c98\u8d34",children:(0,g.jsx)($.ZP,{shape:"circle",icon:(0,g.jsx)(ye.Z,{}),onClick:function(){e((0,y.lb)())},disabled:null===i})}),(0,g.jsx)(Ce.Z,{title:"\u4e0a\u79fb",children:(0,g.jsx)($.ZP,{shape:"circle",icon:(0,g.jsx)(Ie.Z,{}),onClick:function(){l||e((0,y.U)({oldIndex:d,newIndex:d-1}))},disabled:l})}),(0,g.jsx)(Ce.Z,{title:"\u4e0b\u79fb",children:(0,g.jsx)($.ZP,{shape:"circle",icon:(0,g.jsx)(Pe.Z,{}),onClick:function(){r||e((0,y.U)({oldIndex:d,newIndex:d+1}))},disabled:r})}),(0,g.jsx)(Ce.Z,{title:"\u64a4\u9500",children:(0,g.jsx)($.ZP,{shape:"circle",icon:(0,g.jsx)(be.Z,{}),onClick:function(){e(k.zF.undo())}})}),(0,g.jsx)(Ce.Z,{title:"\u91cd\u505a",children:(0,g.jsx)($.ZP,{shape:"circle",icon:(0,g.jsx)(Ne.Z,{}),onClick:function(){e(k.zF.redo())}})})]})})};var we=s(14700);const Le="EditHeader_header-wrapper__J1TD3",Te="EditHeader_header__K5ekc",Ke="EditHeader_left__qMc01",Se="EditHeader_main__h9X6I",ze="EditHeader_right__jboT1",{Title:Fe}=q.default,He=()=>{const e=(0,j.I0)(),{title:n=""}=(0,ae.Z)(),[s,t]=(0,i.useState)(!1);return s?(0,g.jsx)(M.default,{value:n,onPressEnter:()=>t(!1),onBlur:()=>t(!1),onChange:function(n){const s=n.target.value.trim();s&&e((0,oe.r1)(s))}}):(0,g.jsxs)(B.Z,{children:[(0,g.jsx)(Fe,{children:n}),(0,g.jsx)($.ZP,{type:"text",icon:(0,g.jsx)(_e.Z,{}),onClick:()=>t(!0)})]})},Ue=()=>{const{id:e=""}=(0,he.UO)(),{componentList:n=[]}=(0,v.Z)(),s=(0,ae.Z)(),{loading:i,run:t}=(0,me.Z)((async()=>{await(0,we.K8)(e,{...s,componentList:n})}),{manual:!0});return(0,E.Z)(["ctrl.s","meta.s"],(e=>{e.preventDefault(),i||(t(),R.ZP.success("\u4fdd\u5b58\u6210\u529f\ud83d\ude0d"))})),(0,Ze.Z)((()=>{t()}),[n,s],{wait:6e5}),(0,g.jsx)($.ZP,{onClick:function(){t(),R.ZP.success("\u4fdd\u5b58\u6210\u529f\ud83d\ude0d")},disabled:i,icon:i&&(0,g.jsx)(fe.Z,{}),children:"\u4fdd\u5b58"})},qe=()=>{const e=(0,he.s0)(),{id:n=""}=(0,he.UO)(),{componentList:s=[]}=(0,v.Z)(),i=(0,ae.Z)(),{loading:t,run:c}=(0,me.Z)((async()=>{await(0,we.K8)(n,{...i,componentList:s,isPublished:1})}),{manual:!0,onSuccess(){e("/question/stat/"+n),R.ZP.success("\u53d1\u5e03\u6210\u529f\ud83d\ude0d")}});return(0,g.jsx)($.ZP,{type:"primary",disabled:t,onClick:c,children:"\u53d1\u5e03"})},De=()=>{const e=(0,he.s0)();return(0,g.jsx)("div",{className:Le,children:(0,g.jsxs)("div",{className:Te,children:[(0,g.jsx)("div",{className:Ke,children:(0,g.jsxs)(B.Z,{children:[(0,g.jsx)($.ZP,{type:"link",icon:(0,g.jsx)(ve.Z,{}),onClick:()=>e(-1),children:"\u8fd4\u56de"}),(0,g.jsx)(He,{})]})}),(0,g.jsx)("div",{className:Se,children:(0,g.jsx)(ge,{})}),(0,g.jsx)("div",{className:ze,children:(0,g.jsxs)(B.Z,{children:[(0,g.jsx)(Ue,{}),(0,g.jsx)(qe,{})]})})]})})},Oe=()=>{const{loading:e}=(0,z.Z)(),n=(0,j.I0)();return(0,g.jsxs)("div",{className:t,children:[(0,g.jsx)(De,{}),(0,g.jsx)("div",{className:c,children:(0,g.jsxs)("div",{className:d,children:[(0,g.jsx)("div",{className:l,children:(0,g.jsx)(te,{})}),(0,g.jsx)("div",{className:r,onClick:function(){n((0,y.$i)(""))},children:(0,g.jsx)("div",{className:a,children:(0,g.jsx)("div",{children:(0,g.jsx)(S,{loading:e})})})}),(0,g.jsx)("div",{className:o,children:(0,g.jsx)(pe,{})})]})})]})}}}]);
//# sourceMappingURL=editPage.39582956.chunk.js.map